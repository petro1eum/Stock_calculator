# Настройки Monte Carlo в оптимизаторе запасов

## Что такое Monte Carlo симуляция?

Monte Carlo - это метод статистического моделирования, который использует случайные числа для прогнозирования различных сценариев. В контексте управления запасами:

1. **Симулируем тысячи сценариев спроса** - каждый раз генерируем случайный спрос из нормального распределения
2. **Рассчитываем потерянные продажи** - для каждого сценария определяем, сколько продаж потеряем при данном уровне запаса
3. **Усредняем результаты** - получаем ожидаемые потери продаж

## Параметры Monte Carlo

### 1. Количество симуляций
- **Быстро (100)**: Для быстрой оценки, результаты могут "прыгать" между запусками
- **Нормально (1,000)**: Оптимальный баланс скорости и точности
- **Точно (5,000)**: Высокая точность, стабильные результаты

### 2. Доверительный интервал (дополнительные настройки)
- **90%**: Менее консервативная оценка safety stock
- **95%**: Стандартная настройка (рекомендуется)
- **99%**: Очень консервативная оценка, больший safety stock

### 3. Фиксированный seed (дополнительные настройки)
- **Пустое поле**: Случайные результаты каждый раз
- **Любое число**: Воспроизводимые результаты при одинаковых параметрах

## Как это влияет на график?

График показывает **ожидаемую прибыль** при разных уровнях запаса:

1. **При малом запасе**: Много потерянных продаж (определяется через Monte Carlo)
2. **При оптимальном запасе**: Баланс между продажами и затратами
3. **При большом запасе**: Мало потерянных продаж, но высокие затраты на хранение

## Практические рекомендации

### Когда увеличивать количество симуляций:
- Высокая волатильность спроса (CV > 50%)
- Критически важные товары
- Нужны стабильные результаты для отчетности

### Когда можно использовать меньше симуляций:
- Предварительный анализ
- Товары с низкой волатильностью
- Быстрая оценка "что если"

## Интерпретация результатов

### Пример расчета:
- Средний спрос за период: 975 штук
- Стандартное отклонение: 90 штук
- При запасе 900 штук:
  - В ~20% случаев спрос будет > 900
  - Средние потерянные продажи ≈ 30 штук
  - Rush-продажи компенсируют часть потерь

### Что показывает график:
- **Выручка от продаж** = min(запас, спрос) × цена
- **Потерянные продажи** = max(0, спрос - запас)
- **Rush-продажи** = потерянные × вероятность rush

## Технические детали

### Распределение спроса
Используется **нормальное распределение** N(μ, σ²):
- μ = средний спрос за период
- σ = стандартное отклонение за период

### Генерация случайных чисел
- Метод Box-Muller для генерации нормально распределенных значений
- Возможность использования seed для воспроизводимости

### Оптимизация производительности
- Адаптивное количество итераций в зависимости от волатильности
- Кеширование результатов при неизменных параметрах
- Параллельные вычисления для больших объемов данных 